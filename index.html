<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Drum & Bass — Web Player</title>
  <meta name="description" content="A lightweight Drum & Bass web app branded by Velkzie." />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://www.youtube.com/iframe_api"></script>
  <style>
    :root { color-scheme: dark; }
  </style>
</head>
<body class="bg-neutral-950 text-neutral-100 min-h-screen">
  <div class="max-w-6xl mx-auto p-4 md:p-8">
    <header class="flex flex-col md:flex-row md:items-end md:justify-between gap-4">
      <div>
        <h1 class="text-3xl md:text-4xl font-black tracking-tight">Velkzie Drum & Bass</h1>
        <p class="text-neutral-400">A self‑hosted DnB + YouTube player — by Velkzie.</p>
      </div>
    </header>

    <!-- Input for YouTube -->
    <section class="mt-6">
      <input id="youtubeInput" placeholder="Paste YouTube URL here" class="w-full px-4 py-3 rounded-2xl bg-neutral-900 border border-neutral-800 outline-none" />
      <button onclick="loadYouTube()" class="mt-2 px-4 py-2 rounded-xl bg-red-600 text-white">Load YouTube Track</button>
    </section>

    <!-- YouTube Player -->
    <div id="ytContainer" class="mt-4 hidden">
      <img id="ytThumbnail" class="w-40 h-40 rounded-xl object-cover mb-2" />
      <div id="ytTitle" class="font-bold"></div>
      <div id="player" class="mt-2"></div>
    </div>

    <!-- Audio Player Card -->
    <section class="mt-6 grid grid-cols-1 lg:grid-cols-3 gap-6">
      <div class="lg:col-span-2 p-4 rounded-3xl bg-gradient-to-b from-neutral-900 to-neutral-950 border border-neutral-800 shadow-xl">
        <div class="flex items-center gap-4">
          <img id="coverArt" alt="Cover" class="w-24 h-24 rounded-2xl object-cover bg-neutral-800" />
          <div class="min-w-0">
            <div id="nowTitle" class="text-xl font-bold truncate">—</div>
            <div id="nowArtist" class="text-neutral-400 truncate">—</div>
            <div id="nowMeta" class="text-neutral-500 text-sm">BPM — • Tags —</div>
          </div>
        </div>

        <div class="mt-4 flex items-center gap-2">
          <button id="btnPrev" class="px-4 py-3 rounded-2xl bg-neutral-900 border border-neutral-800">⏮️</button>
          <button id="btnPlay" class="px-6 py-3 rounded-2xl bg-neutral-100 text-neutral-900 font-semibold">▶</button>
          <button id="btnNext" class="px-4 py-3 rounded-2xl bg-neutral-900 border border-neutral-800">⏭️</button>
          <input id="vol" type="range" min="0" max="1" step="0.01" value="1" class="w-32" title="Volume" />
        </div>

        <audio id="audio" crossorigin="anonymous" controls></audio>
      </div>

      <aside class="lg:col-span-1 p-4 rounded-3xl bg-neutral-950 border border-neutral-800">
        <h2 class="font-bold mb-2">Playlist</h2>
        <ul id="list" class="space-y-1 max-h-[520px] overflow-auto pr-1"></ul>
      </aside>
    </section>
  </div>

  <script>
    // ======= YouTube Integration =======
    let ytPlayer;
    function onYouTubeIframeAPIReady() {
      ytPlayer = new YT.Player('player', {
        height: '200',
        width: '320',
        videoId: '',
        playerVars: { 'autoplay': 1, 'controls': 1 }
      });
    }

    async function loadYouTube() {
      const url = document.getElementById("youtubeInput").value;
      let id = null;
      if (url.includes("v=")) id = url.split("v=")[1].split("&")[0];
      else if (url.includes("youtu.be/")) id = url.split("youtu.be/")[1].split("?")[0];
      if (id) {
        document.getElementById("ytContainer").classList.remove("hidden");
        ytPlayer.loadVideoById(id);

        // Get YouTube video info via oEmbed
        try {
          const res = await fetch(`https://www.youtube.com/oembed?url=https://www.youtube.com/watch?v=${id}&format=json`);
          const data = await res.json();
          document.getElementById("ytTitle").textContent = data.title;
          document.getElementById("ytThumbnail").src = data.thumbnail_url;
        } catch (err) {
          document.getElementById("ytTitle").textContent = "YouTube Track";
        }
      }
    }

    // ======= Sample Local Tracks =======
    const DEFAULT_TRACKS = [
      {
        id: crypto.randomUUID(),
        title: "Liquid Roller",
        artist: "DJ Placeholder",
        url: "tracks/liquid-roller.mp3",
        cover: "https://images.unsplash.com/photo-1511379938547-c1f69419868d?w=1200",
        bpm: 174,
        tags: ["liquid", "roller"]
      },
      {
        id: crypto.randomUUID(),
        title: "Neurofunk Ripper",
        artist: "Producer X",
        url: "tracks/neurofunk-ripper.mp3",
        cover: "https://images.unsplash.com/photo-1492684223066-81342ee5ff30?w=1200",
        bpm: 172,
        tags: ["neuro", "dark"]
      }
    ];

    const audio = document.getElementById('audio');
    const btnPlay = document.getElementById('btnPlay');
    const vol = document.getElementById('vol');
    const listEl = document.getElementById('list');

    let current = 0;

    function renderList() {
      listEl.innerHTML = '';
      DEFAULT_TRACKS.forEach((t, i) => {
        const li = document.createElement('li');
        li.innerHTML = `<button onclick=\"playTrack(${i})\" class=\"w-full text-left px-3 py-2 rounded-xl bg-neutral-900 hover:bg-neutral-800\">${t.title} — ${t.artist}</button>`;
        listEl.appendChild(li);
      });
    }

    function playTrack(i) {
      current = i;
      audio.src = DEFAULT_TRACKS[i].url;
      audio.play();
      btnPlay.textContent = '⏸';
    }

    btnPlay.addEventListener('click', () => {
      if (audio.paused) { audio.play(); btnPlay.textContent = '⏸'; } else { audio.pause(); btnPlay.textContent = '▶'; }
    });

    vol.addEventListener('input', () => { audio.volume = Number(vol.value); });

    renderList();
  </script>
</body>
</html>
